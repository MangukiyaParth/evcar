ALTER TABLE `tbl_testimonialmaster`   
  ADD COLUMN `rating` INT NULL AFTER `tdate`;

ALTER TABLE `tbl_cars`
  ADD COLUMN `show_on_homepage` TINYINT DEFAULT 0  NULL AFTER `car_type_name`;

ALTER TABLE `tbl_news`   
  ADD COLUMN `show_on_homepage` TINYINT DEFAULT 0  NULL AFTER `short_desc`;


CREATE
    VIEW `car_details` 
    AS
(SELECT id, '' AS main_car_id,`name`,brand,brand_name,price,fule_type,fule_type_name,`engine`,modal_year,transmision,transmision_name,seater,car_type,car_type_name,show_on_homepage,description,`file`,file_data,color_data,verient_data 
FROM tbl_cars
UNION ALL
SELECT v.id, v.`car_id` AS main_car_id,CONCAT(c.name, ' ', v.verient_name),c.brand,c.brand_name,v.price,v.fule_type,v.fule_type_text,v.`engine`,c.modal_year,v.transmision,v.transmision_text,c.seater,c.car_type,c.car_type_name,c.show_on_homepage,c.description,c.`file`,c.file_data,c.color_data,c.verient_data 
FROM `tbl_cars_verient` v INNER JOIN tbl_cars c ON c.`id` = v.`car_id`);

ALTER TABLE `tbl_cars_verient`   
  CHANGE `price` `price` VARCHAR(25) NULL;

ALTER TABLE `tbl_cars`   
  CHANGE `price` `price` VARCHAR(25) NULL;

  ALTER TABLE `tbl_news`
  ADD COLUMN `sub_title` VARCHAR(250) NULL AFTER `title`;

UPDATE tbl_cars_colors SET file_data = REGEXP_REPLACE(file_data, ',"upload":{.*?"}', '');
UPDATE `tbl_brand` SET logo_data = REGEXP_REPLACE(logo_data, ',"upload":{.*?"}', '');
UPDATE `tbl_cars` SET file_data = REGEXP_REPLACE(file_data, ',"upload":{.*?"}', ''), color_data = REGEXP_REPLACE(REPLACE(color_data, ',\\"upload\\":', '----'), '----.*?"}', '');
UPDATE `tbl_news` SET main_image_data = REGEXP_REPLACE(main_image_data, ',"upload":{.*?"}', '');
UPDATE `tbl_slidermaster` SET file_data = REGEXP_REPLACE(file_data, ',"upload":{.*?"}', '');
UPDATE `tbl_testimonialmaster` SET file_data = REGEXP_REPLACE(file_data, ',"upload":{.*?"}', '');

ALTER TABLE `tbl_cars`   
  ADD COLUMN `mileage` VARCHAR(50) NULL AFTER `car_type_name`,
  ADD COLUMN `ground_clearance` INT NULL AFTER `mileage`,
  ADD COLUMN `warranty` VARCHAR(50) NULL AFTER `ground_clearance`,
  ADD COLUMN `fuel_tank` INT NULL AFTER `warranty`,
  ADD COLUMN `length` INT NULL AFTER `fuel_tank`,
  ADD COLUMN `width` INT NULL AFTER `length`,
  ADD COLUMN `height` INT NULL AFTER `width`;


DELIMITER $$
CREATE
    FUNCTION `remove_spacialcharacter`(input_string VARCHAR(255))
    RETURNS VARCHAR(255)
    BEGIN
      DECLARE output_string VARCHAR(255);
      SET output_string = '';
      -- Remove special characters using regular expression
      SET output_string = REPLACE(LOWER(REGEXP_REPLACE(input_string, '[^a-zA-Z0-9 ]', '')),' ','-');

      RETURN output_string;
    END$$

DELIMITER ;